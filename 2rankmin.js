function removeRating(c){if(!c)return;if(typeof c.find=='function')c.find('.card__view .card__lmerating').remove();else if(c instanceof HTMLElement){let e=c.querySelector('.card__view .card__lmerating');e&&e.remove()}}
(function(){var e=!0;try{var t='__lmp_test__';window.localStorage.setItem(t,'1');window.localStorage.removeItem(t)}catch(r){e=!1}if(!e){var n={};window.localStorage={getItem:function(e){return n.hasOwnProperty(e)?n[e]:null},setItem:function(e,t){n[e]=String(t)},removeItem:function(e){delete n[e]},clear:function(){n={}}}}})();(function(e){if(e.Promise)return;function t(){setTimeout(arguments[0],0)}function n(e,n){var r=this;if(!(r instanceof n))return new n(e);r._state=0;r._value=void 0;r._handlers=[];function i(e){if(r._state!==0)return;if(e&&(typeof e=='object'||typeof e=='function')){var t;try{t=e.then}catch(u){return o(u)}if(typeof t=='function')return t.call(e,i,o)}r._state=1;r._value=e;a()}function o(e){if(r._state!==0)return;r._state=2;r._value=e;a()}function a(){t(function(){var e=r._handlers;r._handlers=[];for(var t=0;t<e.length;t++)c(e[t])})}function c(e){if(r._state===0){r._handlers.push(e);return}var t=r._state===1?e.onFulfilled:e.onRejected;if(!t){;(r._state===1?e.resolve:e.reject)(r._value);return}try{var n=t(r._value);e.resolve(n)}catch(u){e.reject(u)}}this.then=function(e,t){return new n(function(n,r){c({onFulfilled:e,onRejected:t,resolve:n,reject:r})})};this.catch=function(e){return this.then(null,e)};try{e(i,o)}catch(u){o(u)}}n.resolve=function(e){return new n(function(t){t(e)})};n.reject=function(e){return new n(function(t,r){r(e)})};n.all=function(e){return new n(function(t,r){if(!e||!e.length)return t([]);var i=new Array(e.length),o=e.length;for(var a=0;a<e.length;a++)(function(a){n.resolve(e[a]).then(function(e){i[a]=e;if(--o===0)t(i)},r)})(a)})};e.Promise=n})(typeof globalThis!=='undefined'?globalThis:typeof window!=='undefined'?window:this);(function(e){if(e.fetch)return;function t(e,t){this.status=t&&t.status||200;this.ok=this.status>=200&&this.status<300;this._body=e==null?'':String(e);this.headers=t&&t.headers||{}}t.prototype.text=function(){var e=this;return Promise.resolve(e._body)};t.prototype.json=function(){var e=this;return Promise.resolve().then(function(){return JSON.parse(e._body||'null')})};e.fetch=function(e,n){n=n||{};var r=typeof e=='string'?e:e&&e.url||'',i=(n.method||'GET').toUpperCase(),o=n.headers||{},a=n.body||null;if(e.Lampa&&Lampa.Reguest){return new Promise(function(e){new Lampa.Reguest().native(r,function(t){var n=typeof t=='string'?t:t!=null?JSON.stringify(t):'';e(new t(n,{status:200,headers:o}))},function(){e(new t('',{status:500,headers:o}))},!1,{dataType:'text',method:i,headers:o,data:a})})}return new Promise(function(e,c){try{var u=new XMLHttpRequest;u.open(i,r,!0);for(var s in o)o.hasOwnProperty(s)&&u.setRequestHeader(s,o[s]);u.onload=function(){e(new t(u.responseText,{status:u.status,headers:o}))};u.onerror=function(){c(new TypeError('Network request failed'))};u.send(a)}catch(l){c(l)}})}})(typeof globalThis!=='undefined'?globalThis:typeof window!=='undefined'?window:this);(function(){if(window.NodeList&&!NodeList.prototype.forEach)NodeList.prototype.forEach=function(e,t){t=t||window;for(var n=0;n<this.length;n++)e.call(t,this[n],n,this)};if(!Element.prototype.matches)Element.prototype.matches=Element.prototype.msMatchesSelector||Element.prototype.webkitMatchesSelector||function(e){var t=this,n=(t.parentNode||document).querySelectorAll(e);for(var r=0;r<n.length;r++)if(n[r]===t)return!0;return!1};if(!Element.prototype.closest)Element.prototype.closest=function(e){for(var t=this;t&&t.nodeType===1;){if(t.matches(e))return t;t=t.parentElement||t.parentNode}return null};var _C={apiKeys:{mdblist:'',omdb:''},monochromeIcons:!1},BI='https://raw.githubusercontent.com/ko3ik/LMP/main/wwwroot/',I={total_star:BI+'star.png',imdb:BI+'imdb.png',tmdb:BI+'tmdb.png',metacritic:BI+'metacritic.png',metascore:BI+'metascore.png',rotten_good:BI+'RottenTomatoes.png',rotten_bad:BI+'RottenBad.png',popcorn:BI+'PopcornGood.png',awards:BI+'awards.png',oscar:BI+'OscarGold.png',emmy:BI+'EmmyGold.png',cub:'https://raw.githubusercontent.com/yumata/lampa/9381985ad4371d2a7d5eb5ca8e3daf0f32669eb7/img/logo-icon.svg'};Lampa.Lang.add({oscars_label:{uk:'Оскар'},emmy_label:{uk:'Еммі'},awards_other_label:{uk:'Нагороди'},popcorn_label:{uk:'Глядачі'},source_tmdb:{ru:'TMDB',en:'TMDB',uk:'TMDB'},source_imdb:{ru:'IMDb',en:'IMDb',uk:'IMDb'},source_mc:{ru:'Metacritic',en:'Metacritic',uk:'Metacritic'},source_rt:{ru:'Rotten',en:'Rotten',uk:'Rotten'},source_cub:{uk:'Cub'}});var PS='<style>.loading-dots-container{display:flex;align-items:center;font-size:.85em;color:#ccc;padding:.6em 1em;border-radius:.5em}.loading-dots__text{margin-right:1em}.loading-dots__dot{width:.5em;height:.5em;border-radius:50%;background-color:currentColor;animation:loading-dots-bounce 1.4s infinite ease-in-out both}.loading-dots__dot:nth-child(1){animation-delay:-.32s}.loading-dots__dot:nth-child(2){animation-delay:-.16s}@keyframes loading-dots-bounce{0%,80%,100%{transform:translateY(0);opacity:.6}40%{transform:translateY(-.5em);opacity:1}}:root{--lmp-h-imdb:22px;--lmp-h-mc:22px;--lmp-h-rt:24px;--lmp-h-popcorn:24px;--lmp-h-tmdb:24px;--lmp-h-awards:18px;--lmp-h-avg:18px;--lmp-h-oscar:20px;--lmp-h-emmy:22px;--lmp-h-cub:22px}.rate--oscars,.rate--emmy,.rate--awards,.rate--gold{color:gold}body.lmp-enh--mono .rate--oscars,body.lmp-enh--mono .rate--emmy,body.lmp-enh--mono .rate--awards,body.lmp-enh--mono .rate--gold,body.lmp-enh--mono .rating--green,body.lmp-enh--mono .rating--blue,body.lmp-enh--mono .rating--orange,body.lmp-enh--mono .rating--red,body.lmp-enh--mono .full-start__rate{color:inherit!important}body:not(.lmp-enh--mono) .full-start__rate.rating--green{color:#2ecc71}body:not(.lmp-enh--mono) .full-start__rate.rating--blue{color:#60a5fa}body:not(.lmp-enh--mono) .full-start__rate.rating--orange{color:#f59e0b}body:not(.lmp-enh--mono) .full-start__rate.rating--red{color:#ef4444}.full-start-new__rate-line .full-start__rate{margin-right:.3em!important}.full-start-new__rate-line .full-start__rate:last-child{margin-right:0!important}.full-start-new__rate-line.lmp-is-loading-ratings>:not(#lmp-search-loader),.full-start__rate-line.lmp-is-loading-ratings>:not(#lmp-search-loader){opacity:0!important;pointer-events:none!important;transition:opacity .15s}.lmp-award-icon{display:inline-flex;align-items:center;justify-content:center;line-height:1;height:auto;width:auto;flex-shrink:0}.lmp-award-icon img{height:auto;width:auto;display:block;object-fit:contain}.lmp-award-icon--oscar img{height:var(--lmp-h-oscar)}.lmp-award-icon--emmy img{height:var(--lmp-h-emmy)}.rate--imdb .source--name img{height:var(--lmp-h-imdb)}.rate--mc .source--name img{height:var(--lmp-h-mc)}.rate--rt .source--name img{height:var(--lmp-h-rt)}.rate--popcorn .source--name img{height:var(--lmp-h-popcorn)}.rate--tmdb .source--name img{height:var(--lmp-h-tmdb)}.rate--awards .source--name img{height:var(--lmp-h-awards)}.rate--avg .source--name img{height:var(--lmp-h-avg)}.rate--cub .source--name img{height:var(--lmp-h-cub)}.full-start__rate .source--name{display:inline-flex;align-items:center;justify-content:center}.settings-param__descr,.settings-param__subtitle{white-space:pre-line}@media (max-width:600px){.full-start-new__rate-line{flex-wrap:wrap}.full-start__rate{margin-right:.25em!important;margin-bottom:.25em;font-size:16px;min-width:unset}:root{--lmp-h-imdb:14px;--lmp-h-mc:14px;--lmp-h-rt:16px;--lmp-h-popcorn:16px;--lmp-h-tmdb:16px;--lmp-h-awards:14px;--lmp-h-avg:14px;--lmp-h-oscar:14px;--lmp-h-emmy:16px;--lmp-h-cub:16px}.loading-dots-container{font-size:.8em;padding:.4em .8em}.lmp-award-icon{height:16px}}@media (max-width:360px){.full-start__rate{font-size:14px}:root{--lmp-h-imdb:12px;--lmp-h-mc:12px;--lmp-h-rt:14px;--lmp-h-popcorn:14px;--lmp-h-tmdb:14px;--lmp-h-awards:12px;--lmp-h-avg:12px;--lmp-h-oscar:12px;--lmp-h-emmy:14px;--lmp-h-cub:14px}.lmp-award-icon{height:12px}}body.lmp-enh--rate-border .full-start__rate{border:1px solid rgba(255,255,255,.45);border-radius:.3em;box-sizing:border-box}.full-start__rate.rate--kp,.rate--kp{display:none!important}</style>',CT=2592e5,RCK='lmp_enh_rating_cache',IMC='lmp_rating_id_cache',AR={G:'3+',PG:'6+','PG-13':'13+',R:'17+','NC-17':'18+','TV-Y':'0+','TV-Y7':'7+','TV-G':'3+','TV-PG':'6+','TV-14':'14+','TV-MA':'17+'},D={ratings_omdb_key:'',ratings_mdblist_key:'',ratings_bw_logos:!1,ratings_show_awards:!0,ratings_show_average:!0,ratings_logo_offset:0,ratings_font_offset:0,ratings_badge_alpha:.15,ratings_badge_tone:0,ratings_gap_step:0,ratings_colorize_all:!1,ratings_enable_imdb:!0,ratings_enable_tmdb:!0,ratings_enable_mc:!0,ratings_enable_rt:!0,ratings_enable_popcorn:!0,ratings_enable_cub:!0,ratings_poster_badges:!1,ratings_rate_border:!1};function gc(){var e=!!Lampa.Storage.field('ratings_bw_logos',D.ratings_bw_logos),t=!!Lampa.Storage.field('ratings_show_awards',D.ratings_show_awards),n=!!Lampa.Storage.field('ratings_show_average',D.ratings_show_average),r=parseInt(Lampa.Storage.get('ratings_logo_offset',D.ratings_logo_offset),10);isNaN(r)&&(r=0);var i=parseInt(Lampa.Storage.get('ratings_font_offset',D.ratings_font_offset),10);isNaN(i)&&(i=0);var o=parseFloat(Lampa.Storage.get('ratings_badge_alpha',D.ratings_badge_alpha));isNaN(o)?o=D.ratings_badge_alpha:o<0?o=0:o>1&&(o=1);var a=parseInt(Lampa.Storage.get('ratings_badge_tone',D.ratings_badge_tone),10);isNaN(a)?a=D.ratings_badge_tone:a<0?a=0:a>255&&(a=255);var c=parseInt(Lampa.Storage.get('ratings_gap_step',D.ratings_gap_step),10);isNaN(c)||c<0?c=0:0;var u=!!Lampa.Storage.field('ratings_colorize_all',D.ratings_colorize_all),s=!!Lampa.Storage.field('ratings_enable_imdb',D.ratings_enable_imdb),l=!!Lampa.Storage.field('ratings_enable_tmdb',D.ratings_enable_tmdb),d=!!Lampa.Storage.field('ratings_enable_mc',D.ratings_enable_mc),f=!!Lampa.Storage.field('ratings_enable_rt',D.ratings_enable_rt),p=!!Lampa.Storage.field('ratings_enable_popcorn',D.ratings_enable_popcorn),g=!!Lampa.Storage.field('ratings_enable_cub',D.ratings_enable_cub),m=!!Lampa.Storage.field('ratings_poster_badges',D.ratings_poster_badges),v=!!Lampa.Storage.field('ratings_rate_border',D.ratings_rate_border);return{omdbKey:Lampa.Storage.get('ratings_omdb_key',D.ratings_omdb_key)||'',mdblistKey:Lampa.Storage.get('ratings_mdblist_key',D.ratings_mdblist_key)||'',bwLogos:e,showAwards:t,showAverage:n,logoOffset:r,fontOffset:i,badgeAlpha:o,badgeTone:a,gapStep:c,colorizeAll:u,enableImdb:s,enableTmdb:l,enableMc:d,enableRt:f,enablePop:p,enableCub:g,enablePosterBadges:m,rateBorder:v}}function rCfg(){var e=gc();return _C.apiKeys.omdb=e.omdbKey||'',_C.apiKeys.mdblist=e.mdblistKey||'',_C.monochromeIcons=e.bwLogos,e.bwLogos?$('body').addClass('lmp-enh--mono'):$('body').removeClass('lmp-enh--mono'),e}function aC(e){return e&&typeof e=='object'&&e._mdblist_ratings&&e._mdblist_ratings.length?e._mdblist_ratings.slice():(e=e||{},[])}function fM(e,t){var n=_C.apiKeys.mdblist;if(!n){t(null);return}var r=e.type=='tv'?'show':e.type,i='https://api.mdblist.com/tmdb/'+r+'/'+e.id+'?apikey='+encodeURIComponent(n);new Lampa.Reguest().silent(i,o,function(){new Lampa.Reguest().native(i,function(e){try{o(typeof e=='string'?JSON.parse(e):e)}catch(u){t(null)}},function(){t(null)},!1,{dataType:'json'})});function o(n){if(!n||!n.ratings||!n.ratings.length){t(null);return}var r={tmdb_display:null,tmdb_for_avg:null,imdb_display:null,imdb_for_avg:null,mc_user_display:null,mc_user_for_avg:null,mc_critic_display:null,mc_critic_for_avg:null,rt_display:null,rt_for_avg:null,rt_fresh:null,popcorn_display:null,popcorn_for_avg:null};function i(e){return e==null?null:typeof e=='number'?e:typeof e=='string'?e.indexOf('%')!=-1?parseFloat(e.replace('%','')):e.indexOf('/')!=-1?parseFloat(e.split('/')[0]):parseFloat(e):null}n.ratings.forEach(function(e){var n=(e.source||'').toLowerCase(),o=i(e.value);if(o==null||isNaN(o))return;if(n.indexOf('tmdb')!=-1){var a=o>10?o/10:o;r.tmdb_display=a.toFixed(1);r.tmdb_for_avg=a}if(n.indexOf('imdb')!=-1){var c=o>10?o/10:o;r.imdb_display=c.toFixed(1);r.imdb_for_avg=c}if(n.indexOf('metacritic')!=-1&&(n.indexOf('user')!=-1||n.indexOf('users')!=-1||n.indexOf('metacriticuser')!=-1||n.indexOf('metacritic_user')!=-1)){var u=o>10?o/10:o;r.mc_user_display=u.toFixed(1);r.mc_user_for_avg=u}if(n.indexOf('metacritic')!=-1&&!(n.indexOf('user')!=-1||n.indexOf('users')!=-1||n.indexOf('metacriticuser')!=-1||n.indexOf('metacritic_user')!=-1)){var s=o>10?o/10:o;r.mc_critic_display=s.toFixed(1);r.mc_critic_for_avg=s}if(n.indexOf('rotten')!=-1||n.indexOf('tomato')!=-1){r.rt_display=String(Math.round(o));r.rt_for_avg=o/10;r.rt_fresh=o>=60}if(n.indexOf('popcorn')!=-1||n.indexOf('audience')!=-1){r.popcorn_display=String(Math.round(o));r.popcorn_for_avg=o/10}});r._mdblist_ratings=Array.isArray(n.ratings)?n.ratings.slice():[];t(r)}}function fO(e,t){var n=_C.apiKeys.omdb;if(!n||!e.imdb_id){t(null);return}var r=e.type=='tv'?'&type=series':'',i='https://www.omdbapi.com/?apikey='+encodeURIComponent(n)+'&i='+encodeURIComponent(e.imdb_id)+r;new Lampa.Reguest().silent(i,function(e){if(!e||e.Response!=='True'){t(null);return}var n=function(e){var t={oscars:0,emmy:0,awards:0};if(typeof e!='string')return t;var n=e.match(/Won (\d+) Oscars?/i);n&&n[1]&&(t.oscars=parseInt(n[1],10));var r=e.match(/Won (\d+) Primetime Emmys?/i);r&&r[1]&&(t.emmy=parseInt(r[1],10));var i=e.match(/Another (\d+) wins?/i);i&&i[1]&&(t.awards=parseInt(i[1],10));t.awards===0&&(i=e.match(/(\d+) wins?/i))&&i[1]&&(t.awards=parseInt(i[1],10));return t}(e.Awards||''),r=null,i=null;Array.isArray(e.Ratings)&&e.Ratings.forEach(function(e){if(e.Source==='Rotten Tomatoes'){var t=parseInt((e.Value||'').replace('%',''));isNaN(t)||(r=t)}if(e.Source==='Metacritic'){var n=parseInt((e.Value||'').split('/')[0]);isNaN(n)||(i=n)}});var o=i!=null&&!isNaN(i)?(i>10?i/10:i):null;t({tmdb_display:null,tmdb_for_avg:null,imdb_display:e.imdbRating&&e.imdbRating!=='N/A'?parseFloat(e.imdbRating).toFixed(1):null,imdb_for_avg:e.imdbRating&&e.imdbRating!=='N/A'?parseFloat(e.imdbRating):null,mc_user_display:null,mc_user_for_avg:null,mc_critic_display:o!=null?o.toFixed(1):null,mc_critic_for_avg:o!=null?o:null,rt_display:r!=null&&!isNaN(r)?String(r):null,rt_for_avg:r!=null&&!isNaN(r)?r/10:null,rt_fresh:r!=null&&!isNaN(r)?r>=60:null,popcorn_display:null,popcorn_for_avg:null,ageRating:e.Rated||null,oscars:n.oscars||0,emmy:n.emmy||0,awards:n.awards||0})},function(){t(null)})}function gC(e){if(!e.object||!e.object.source||!(e.object.source==='cub'||e.object.source==='tmdb'))return null;var t=e.object.method==='tv',n={fire:10,nice:7.5,think:5,bore:2.5,shit:0},r=0,i=0;if(e.data&&e.data.reactions&&e.data.reactions.result){var o=e.data.reactions.result;for(var a=0;a<o.length;a++){var c=n[o[a].type];o[a].counter&&(r+=o[a].counter*c,i+=o[a].counter*1)}}if(i>=20){var u=t?7.436:6.584,s=t?69:274;return((u*s+r)/(s+i)).toFixed(1)}return null}function mR(e,t,n){e=e||{};t=t||{};n=n||null;var r=null,i=null;e.mc_user_display?(r=e.mc_user_display,i=e.mc_user_for_avg):e.mc_critic_display?(r=e.mc_critic_display,i=e.mc_critic_for_avg):t.mc_critic_display&&(r=t.mc_critic_display,i=t.mc_critic_for_avg);return{tmdb_display:e.tmdb_display||null,tmdb_for_avg:e.tmdb_for_avg||null,imdb_display:e.imdb_display||t.imdb_display||null,imdb_for_avg:e.imdb_for_avg||t.imdb_for_avg||null,mc_user_display:e.mc_user_display||null,mc_user_for_avg:typeof e.mc_user_for_avg=='number'?e.mc_user_for_avg:null,mc_critic_display:e.mc_critic_display||t.mc_critic_display||null,mc_critic_for_avg:typeof e.mc_critic_for_avg=='number'?e.mc_critic_for_avg:typeof t.mc_critic_for_avg=='number'?t.mc_critic_for_avg:null,mc_display:r||null,mc_for_avg:typeof i=='number'?i:null,rt_display:e.rt_display||t.rt_display||null,rt_for_avg:e.rt_for_avg||t.rt_for_avg||null,rt_fresh:e.rt_display||t.rt_display?e.rt_display?e.rt_fresh:t.rt_fresh:null,popcorn_display:e.popcorn_display||null,popcorn_for_avg:e.popcorn_for_avg||null,ageRating:t.ageRating||null,oscars:t.oscars||0,emmy:t.emmy||0,awards:t.awards||0,cub_display:n?n:null,cub_for_avg:n?parseFloat(n):null,_mdblist_ratings:Array.isArray(e._mdblist_ratings)?e._mdblist_ratings.slice():[]}}function gR(e){var t=parseFloat(e);return isNaN(t)?'rating--red':t>=8?'rating--green':t>=6?'rating--blue':t>=4?'rating--orange':'rating--red'}function rP(e){if(!e||!e.length)return;e.addClass('lmp-is-loading-ratings')}function uP(e){e&&e.length&&e.removeClass('lmp-is-loading-ratings')}function gPL(e){if(!e||!e[0])return;var t=Lampa.Activity.active().activity.render(),n=$(t);if(!n.length)return;var r=n.find('.full-start-new__rate-line:not([data-lmp-fake]), .full-start__rate-line:not([data-lmp-fake])').filter(function(){return!$(this).closest('.cardify__right').length}).first();return r.length?r:$()}function aLA(){var e=Lampa.Activity.active().activity.render();if(!e||!e[0])return;if($('#lmp-search-loader',e).length)return;var t='<div id="lmp-search-loader" class="loading-dots-container"><div class="loading-dots__text">Пошук…</div><div class="loading-dots__dot"></div><div class="loading-dots__dot"></div><div class="loading-dots__dot"></div></div>',n=gPL(e);if(n.length){n.append(t);rP(n);return}var r=$('<div class="full-start-new__rate-line" id="lmp-loader-fake" data-lmp-fake="1" style="min-height:28px; display:flex; align-items:center;"></div>'),i=$('.full-start-new__title, .full-start__title',e).first();i.length?i.after(r):$(e).append(r);r.append(t);var o=null;try{o&&o.disconnect()}catch(a){}o=new MutationObserver(function(){var t=gPL(e),r=$('#lmp-search-loader',e);t.length&&r.length&&(t.append(r),rP(t),$('#lmp-loader-fake',e).remove(),o.disconnect())});o.observe(e[0],{childList:!0,subtree:!0});setTimeout(function(){o&&o.disconnect()},6e3)}function rLA(){var e=Lampa.Activity.active().activity.render();if(!e||!e[0])return;$('#lmp-search-loader',e).remove();$('#lmp-loader-fake',e).remove();var t=gPL(e);t.length&&uP(t);try{__lmpRateLineObs&&__lmpRateLineObs.disconnect()}catch(n){}__lmpRateLineObs=null}function gCK(e){var t=Lampa.Storage.get(RCK)||{},n=t[e];return n&&Date.now()-n.timestamp<=CT?n.data||null:null}function sCK(e,t){if(!t)return;var n=Lampa.Storage.get(RCK)||{};n[e]={timestamp:Date.now(),data:t};Lampa.Storage.set(RCK,n)}function gIT(e,t,n){if(!e)return n(null);var r=t==='movie'?'movie':'tv',i=r==='movie'?'tv':'movie',o=Lampa.Storage.get(IMC)||{},a=Date.now();function c(t){var n=o[t];return n&&n.imdb_id&&a-n.timestamp<=CT?n.imdb_id:null}var u=c(r+'_'+e)||c(i+'_'+e);if(u)return n(u);var s=Lampa.TMDB.key(),l=['https://api.themoviedb.org/3/'+r+'/'+e+'/external_ids?api_key='+s,'https://api.themoviedb.org/3/'+r+'/'+e+'?api_key='+s+'&append_to_response=external_ids','https://api.themoviedb.org/3/'+i+'/'+e+'/external_ids?api_key='+s,'https://api.themoviedb.org/3/'+i+'/'+e+'?api_key='+s+'&append_to_response=external_ids'];function d(e,t,r){new Lampa.Reguest().silent(e,t,function(){new Lampa.Reguest().native(e,function(e){try{t(typeof e=='string'?JSON.parse(e):e)}catch(i){r()}},r,!1,{dataType:'json'})})}function f(t){if(!t||typeof t!='object')return null;return t.imdb_id&&typeof t.imdb_id=='string'?t.imdb_id:t.external_ids&&typeof t.external_ids.imdb_id=='string'?t.external_ids.imdb_id:null}function p(e){var t={imdb_id:e,timestamp:Date.now()};o[r+'_'+e]=t;o[i+'_'+e]=t;Lampa.Storage.set(IMC,o);n(e)}!function t(){var i=l.shift();if(!i)return n(null);d(i,function(e){var r=f(e);r?p(r):t()},function(){t()})}()}function fAR(e){var t=Lampa.Activity.active().activity.render();if(!t)return;rCfg();var n={id:e.id,imdb_id:e.imdb_id||e.imdb||null,title:e.title||e.name||'',original_title:e.original_title||e.original_name||'',type:function(e){var t=e.media_type||e.type;return t==='movie'||t==='tv'?t:e.name||e.original_name?'tv':'movie'}(e),release_date:e.release_date||e.first_air_date||'',vote:e.vote_average||e.vote||null},i=(n.type||'')+'_'+(n.imdb_id||n.id||'')+'_'+Date.now();__lmpLastReqToken=i;function o(){if(i!==__lmpLastReqToken)return;if(!currentRatingsData){rLA();return}!function(e){var t=Lampa.Activity.active().activity.render();if(!t||!t[0])return;var n=gc(),r=$('.full-start__pg.hide',t);r.length&&e.ageRating&&(function(e){return['N/A','Not Rated','Unrated'].indexOf(e)===-1}(e.ageRating)&&r.removeClass('hide').text(AR[e.ageRating]||e.ageRating));var i=$('.rate--imdb',t);i.length&&(n.enableImdb&&e.imdb_display?(i.removeClass('hide'),i.find('> div').eq(0).text(parseFloat(e.imdb_display).toFixed(1)),i.find('.source--name').html('<img style="width:auto; display:inline-block; vertical-align:middle; object-fit:contain;" src="'+I.imdb+'" alt="IMDb">'),i.removeClass('rating--green rating--blue rating--orange rating--red'),n.colorizeAll&&e.imdb_for_avg&&!isNaN(e.imdb_for_avg)&&i.addClass(gR(parseFloat(e.imdb_for_avg)))):i.addClass('hide').removeClass('rating--green rating--blue rating--orange rating--red'));var o=$('.rate--tmdb',t);o.length&&(n.enableTmdb&&e.tmdb_display?(o.removeClass('hide'),o.find('> div').eq(0).text(parseFloat(e.tmdb_display).toFixed(1)),o.find('.source--name').html('<img style="width:auto; display:inline-block; vertical-align:middle; object-fit:contain;" src="'+I.tmdb+'" alt="TMDB">'),o.removeClass('hide rating--green rating--blue rating--orange rating--red'),n.colorizeAll&&e.tmdb_for_avg&&!isNaN(e.tmdb_for_avg)&&o.addClass(gR(parseFloat(e.tmdb_for_avg)))):o.addClass('hide').removeClass('rating--green rating--blue rating--orange rating--red'))}(currentRatingsData);!function(e){var t=Lampa.Activity.active().activity.render();if(!t)return;var n=gPL(t);if(!n.length)return;var r=gc();!function(){var t=n.find('.rate--mc');if(!r.enableMc){t.remove();return}var i=null;e.mc_user_for_avg&&!isNaN(e.mc_user_for_avg)?i=parseFloat(e.mc_user_for_avg):e.mc_critic_for_avg&&!isNaN(e.mc_critic_for_avg)?i=parseFloat(e.mc_critic_for_avg):e.mc_for_avg&&!isNaN(e.mc_for_avg)?i=parseFloat(e.mc_for_avg):e.mc_display&&!isNaN(parseFloat(e.mc_display))&&(i=parseFloat(e.mc_display)>10?parseFloat(e.mc_display)/10:parseFloat(e.mc_display));if(i==null||isNaN(i)){t.remove();return}var o=i.toFixed(1),a=(e.mc_user_for_avg&&!isNaN(e.mc_user_for_avg)&&Math.abs(i-parseFloat(e.mc_user_for_avg))<.051)?I.metacritic:I.metascore;if(!t.length){t=$('<div class="full-start__rate rate--mc"><div>'+o+'</div><div class="source--name"></div></div>');t.find('.source--name').html('<img style="width:auto; display:inline-block; vertical-align:middle; object-fit:contain;" src="'+a+'" alt="Metacritic">');var c=n.find('.rate--imdb');c.length?t.insertAfter(c):n.append(t)}else{t.find('> div').eq(0).text(o);t.find('.source--name').html('<img style="width:auto; display:inline-block; vertical-align:middle; object-fit:contain;" src="'+a+'" alt="Metacritic">')}t.removeClass('rating--green rating--blue rating--orange rating--red');r.colorizeAll&&t.addClass(gR(i))}();!function(){var t=n.find('.rate--rt');if(!r.enableRt){t.remove();return}var i=null;e.rt_for_avg&&!isNaN(e.rt_for_avg)?i=parseFloat(e.rt_for_avg):e.rt_display&&!isNaN(parseFloat(e.rt_display))&&(i=parseFloat(e.rt_display)>10?parseFloat(e.rt_display)/10:parseFloat(e.rt_display));if(i==null||isNaN(i)){t.remove();return}var o=i.toFixed(1),a=e.rt_fresh?I.rotten_good:I.rotten_bad,c=e.rt_fresh?'border-radius:4px;':'';if(!t.length){t=$('<div class="full-start__rate rate--rt"><div>'+o+'</div><div class="source--name"></div></div>');t.find('.source--name').html('<img style="width:auto; display:inline-block; vertical-align:middle; object-fit:contain;'+c+'" src="'+a+'" alt="Rotten Tomatoes">');var u=n.find('.rate--mc');u.length?t.insertAfter(u):(u=n.find('.rate--imdb')).length?t.insertAfter(u):n.prepend(t)}else{t.find('> div').eq(0).text(o);t.find('.source--name').html('<img style="width:auto; display:inline-block; vertical-align:middle; object-fit:contain;'+c+'" src="'+a+'" alt="Rotten Tomatoes">')}t.removeClass('rating--green rating--blue rating--orange rating--red');r.colorizeAll&&t.addClass(gR(i))}();!function(){var t=n.find('.rate--popcorn');if(!r.enablePop){t.remove();return}var i=null;e.popcorn_for_avg&&!isNaN(e.popcorn_for_avg)?i=parseFloat(e.popcorn_for_avg):e.popcorn_display&&!isNaN(parseFloat(e.popcorn_display))&&(i=parseFloat(e.popcorn_display)>10?parseFloat(e.popcorn_display)/10:parseFloat(e.popcorn_display));if(i==null||isNaN(i)){t.remove();return}var o=i.toFixed(1);if(!t.length){t=$('<div class="full-start__rate rate--popcorn"><div>'+o+'</div><div class="source--name"></div></div>');t.find('.source--name').html('<img style="width:auto; display:inline-block; vertical-align:middle; object-fit:contain;" src="'+I.popcorn+'" alt="Audience">');var a=n.find('.rate--rt, .rate--mc, .rate--tmdb, .rate--imdb');a.length?t.insertAfter(a.last()):n.prepend(t)}else{t.find('> div').eq(0).text(o);t.find('.source--name').html('<img style="width:auto; display:inline-block; vertical-align:middle; object-fit:contain;" src="'+I.popcorn+'" alt="Audience">')}t.removeClass('rating--green rating--blue rating--orange rating--red');r.colorizeAll&&t.addClass(gR(i))}();!function(){var t=n.find('.rate--cub');if(!r.enableCub){t.remove();return}var i=null;e.cub_for_avg&&!isNaN(e.cub_for_avg)&&(i=parseFloat(e.cub_for_avg));if(i==null||isNaN(i)){t.remove();return}var o=i.toFixed(1);if(!t.length){t=$('<div class="full-start__rate rate--cub"><div>'+o+'</div><div class="source--name"></div></div>');t.find('.source--name').html('<span class="lmp-award-icon lmp-award-icon--cub"><img src="'+I.cub+'" alt="Cub" style="height:var(--lmp-h-cub);"></span>');var a=n.find('.rate--popcorn');a.length?t.insertAfter(a):(a=n.find('.full-start__rate').last()).length?t.insertAfter(a):n.prepend(t)}else{t.find('> div').eq(0).text(o);t.find('.source--name').html('<span class="lmp-award-icon lmp-award-icon--cub"><img src="'+I.cub+'" alt="Cub" style="height:var(--lmp-h-cub);"></span>')}t.removeClass('rating--green rating--blue rating--orange rating--red');r.colorizeAll&&t.addClass(gR(i))}();e.awards&&e.awards>0&&!n.find('.rate--awards').length&&$('<div class="full-start__rate rate--awards rate--gold"><div>'+e.awards+'</div><div class="source--name"></div></div>').find('.source--name').html('<img style="width:auto; display:inline-block; vertical-align:middle; object-fit:contain;" src="'+I.awards+'" alt="Awards">').attr('title',Lampa.Lang.translate('awards_other_label')).end().prependTo(n);e.emmy&&e.emmy>0&&!n.find('.rate--emmy').length&&$('<div class="full-start__rate rate--emmy rate--gold"><div>'+e.emmy+'</div><div class="source--name"></div></div>').find('.source--name').html('<span class="lmp-award-icon lmp-award-icon--emmy"><img src="'+I.emmy+'" alt="Emmy"></span>').attr('title',Lampa.Lang.translate('emmy_label')).end().prependTo(n);e.oscars&&e.oscars>0&&!n.find('.rate--oscars').length&&$('<div class="full-start__rate rate--oscars rate--gold"><div>'+e.oscars+'</div><div class="source--name"></div></div>').find('.source--name').html('<span class="lmp-award-icon lmp-award-icon--oscar"><img src="'+I.oscar+'" alt="Oscar"></span>').attr('title',Lampa.Lang.translate('oscars_label')).end().prependTo(n);try{!function(e,t){var r=e.find('.rate--awards, .rate--oscars, .rate--emmy');r.removeClass('rating--green rating--blue rating--orange rating--red');t&&t.colorizeAll?r.addClass('rate--gold'):r.removeClass('rate--gold')}(n,r)}catch(s){}}(currentRatingsData);!function(e){var t=Lampa.Activity.active().activity.render();if(!t)return;var n=gPL(t);if(!n.length)return;var r=gc();n.find('.rate--avg').remove();if(!r.showAverage){try{!function(e,t){var r=e.find('.rate--awards, .rate--oscars, .rate--emmy');r.removeClass('rating--green rating--blue rating--orange rating--red');t&&t.colorizeAll?r.addClass('rate--gold'):r.removeClass('rate--gold')}(n,r)}catch(i){}rLA();uP(n);return}var o=[];r.enableTmdb&&e.tmdb_for_avg&&!isNaN(e.tmdb_for_avg)&&o.push(parseFloat(e.tmdb_for_avg));r.enableImdb&&e.imdb_for_avg&&!isNaN(e.imdb_for_avg)&&o.push(parseFloat(e.imdb_for_avg));if(r.enableMc){e.mc_user_for_avg&&!isNaN(e.mc_user_for_avg)?o.push(parseFloat(e.mc_user_for_avg)):e.mc_critic_for_avg&&!isNaN(e.mc_critic_for_avg)?o.push(parseFloat(e.mc_critic_for_avg)):e.mc_for_avg&&!isNaN(e.mc_for_avg)&&o.push(parseFloat(e.mc_for_avg))}r.enableRt&&e.rt_for_avg&&!isNaN(e.rt_for_avg)&&o.push(parseFloat(e.rt_for_avg));r.enablePop&&e.popcorn_for_avg&&!isNaN(e.popcorn_for_avg)&&o.push(parseFloat(e.popcorn_for_avg));r.enableCub&&e.cub_for_avg&&!isNaN(e.cub_for_avg)&&o.push(parseFloat(e.cub_for_avg));if(!o.length){rLA();uP(n);return}var a=0;for(var c=0;c<o.length;c++)a+=o[c];var u=a/o.length,s=r.colorizeAll?gR(u):'';$('<div class="full-start__rate rate--avg '+s+'"><div>'+u.toFixed(1)+'</div><div class="source--name"></div></div>').find('.source--name').html('<img style="width:auto; display:inline-block; vertical-align:middle; object-fit:contain;" src="'+I.total_star+'" alt="AVG">').end().insertBefore(n.find('.full-start__rate:first'));try{!function(e,t){var r=e.find('.rate--awards, .rate--oscars, .rate--emmy');r.removeClass('rating--green rating--blue rating--orange rating--red');t&&t.colorizeAll?r.addClass('rate--gold'):r.removeClass('rate--gold')}(n,r)}catch(l){}rLA();uP(n)}(currentRatingsData);try{!function(e,t){var n=gc();if(!n.enablePosterBadges)return;var r=(t||Lampa.Activity.active().activity.render&&Lampa.Activity.active().activity.render());if(!r||!r.length)return;var i=r.find('.full-start-new__poster, .full-start__poster').first();if(!i.length)return;i.find('.card__lmerating').remove();var o=aC(e);if(!o.length)return;o.forEach(function(e,t){var n=$('<div class="card__lmerating"></div>');n.css('top','calc(0.8em + '+t*2+'em)');n.text(String(e.source||'').toUpperCase()+': '+String(e.value));i.append(n)})}(currentRatingsData)}catch(l){}!function(){var e=gc();e.bwLogos?$('body').addClass('lmp-enh--mono'):$('body').removeClass('lmp-enh--mono');e.rateBorder?$('body').addClass('lmp-enh--rate-border'):$('body').removeClass('lmp-enh--rate-border');!function(e){var t=document.querySelectorAll('.rate--oscars, .rate--emmy, .rate--awards');t.forEach(function(t){t.style.display=e?'':'none'})}(e.showAwards);!function(e){var t=document.querySelectorAll('.rate--avg');t.forEach(function(t){t.style.display=e?'':'none'})}(e.showAverage);!function(e){var t=parseFloat(e)||0,n=document.querySelectorAll('.full-start__rate');n.forEach(function(e){e.style.fontSize='';var n=parseFloat(getComputedStyle(e).fontSize);isNaN(n)&&(n=23);var r=Math.max(1,n+t);e.style.fontSize=r+'px'})}(e.fontOffset);!function(e){var t=(28+(parseFloat(e)||0))/28;t<.1&&(t=.1);var n=document.querySelectorAll('.full-start__rate .source--name img, .rate--imdb > div:nth-child(2) img, .rate--tmdb > div:nth-child(2) img, .lmp-award-icon img');function r(e){var t=getComputedStyle(document.documentElement).getPropertyValue(e),n=parseFloat(t);return isNaN(n)?null:n}n.forEach(function(n){var i=null;n.closest('.rate--imdb')?i='--lmp-h-imdb':n.closest('.rate--tmdb')?i='--lmp-h-tmdb':n.closest('.rate--mc')?i='--lmp-h-mc':n.closest('.rate--rt')?i='--lmp-h-rt':n.closest('.rate--popcorn')?i='--lmp-h-popcorn':n.closest('.rate--awards')?i='--lmp-h-awards':n.closest('.rate--avg')?i='--lmp-h-avg':n.closest('.rate--oscars')||n.closest('.lmp-award-icon--oscar')?i='--lmp-h-oscar':n.closest('.rate--emmy')||n.closest('.lmp-award-icon--emmy')?i='--lmp-h-emmy':(n.closest('.rate--cub')||n.closest('.lmp-award-icon--cub'))&&(i='--lmp-h-cub');var o=r(i);(!o||o<=0)&&(o=24);var a=Math.max(1,o*t);n.style.height=a+'px';n.style.maxHeight=a+'px'})}(e.logoOffset);!function(e,t){var n='rgba('+e+','+e+','+e+','+t+')',r=document.querySelectorAll('.full-start__rate');r.forEach(function(e){e.style.background=n;var t=e.firstElementChild;t&&(t.style.background=n)})}(e.badgeTone,e.badgeAlpha);!function(e){var t=document.querySelectorAll('.full-start-new__rate-line'),n=.3+e*.1;t.forEach(function(e){for(var t=e.children,r=0;r<t.length;r++)t[r].style.setProperty('margin-right',n+'em','important');e.lastElementChild&&e.lastElementChild.style.setProperty('margin-right','0','important')})}(e.gapStep);!function(e){var t=document.querySelectorAll('.full-start__rate .source--name img, .rate--imdb > div:nth-child(2) img, .rate--tmdb > div:nth-child(2) img, .lmp-award-icon img'),n=e?'grayscale(100%)':'';t.forEach(function(e){e.style.filter=n})}(e.bwLogos)}()}function a(){if(i!==__lmpLastReqToken)return;if(!currentRatingsData){rLA();return}o()}function c(){var e=n.imdb_id||n.id,t=e?n.type+'_'+e:null,r=t?gCK(t):null;if(r){currentRatingsData=r;a();return}aLA();var o=2,u=null,s=null,l=gC(arguments[arguments.length-1]);function d(){o--;if(o!==0)return;currentRatingsData=mR(u,s,l);(!currentRatingsData.tmdb_display||!currentRatingsData.tmdb_for_avg)&&n.vote!=null&&function(){var e=parseFloat(n.vote);if(!isNaN(e)){e>10&&(e/=10);e<0&&(e=0);e>10&&(e=10);currentRatingsData.tmdb_for_avg=e;currentRatingsData.tmdb_display=e.toFixed(1)}}();t&&currentRatingsData&&(currentRatingsData.tmdb_display||currentRatingsData.imdb_display||currentRatingsData.mc_display||currentRatingsData.rt_display||currentRatingsData.popcorn_display||currentRatingsData.cub_display||currentRatingsData.oscars||currentRatingsData.emmy||currentRatingsData.awards)&&sCK(t,currentRatingsData);a()}fM(n,function(e){u=e||{};d()});fO(n,function(e){s=e||{};d()})}n.imdb_id?c():gIT(n.id,n.type,function(e){n.imdb_id=e;c()})}Lampa.Listener.follow('full',function(e){if(e.type==='complite'){setTimeout(function(){fAR(e.data.movie||e.object||{},e);try{var t=Lampa.Activity.active().activity.render();if(t&&t[0]){var n=t[0].querySelectorAll('.full-start__rate > div:first-child');n.forEach(function(e){var t=(e.textContent||'').replace(/\u00A0/g,' ').trim();/^10(?:[.,]0+)?$/.test(t)&&(e.textContent='10')})}}catch(r){}},500)}});Lampa.Template.add('lmp_enh_styles',PS);$('body').append(Lampa.Template.get('lmp_enh_styles',{},!0));!function(){function e(){window.__lmpRatingsPatchedStorage||(window.__lmpRatingsPatchedStorage=!0,function(){var e=Lampa.Storage.set;Lampa.Storage.set=function(t,n){var r=e.apply(this,arguments);return typeof t=='string'&&t.indexOf('ratings_')===0&&setTimeout(l,0),r}}())}function t(){var e;clearTimeout(e);e=setTimeout(l,150)}function n(){if(window.lmp_ratings_add_param_ready)return;window.lmp_ratings_add_param_ready=!0;Lampa.SettingsApi.addComponent({component:'lmp_ratings',name:'Рейтинги',icon:'<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M12 3l3.09 6.26L22 10.27l-5 4.87L18.18 21 12 17.77 5.82 21 7 15.14l-5-4.87 6.91-1.01L12 3z" stroke="currentColor" stroke-width="2" fill="none" stroke-linejoin="round" stroke-linecap="round"/></svg>'});Lampa.SettingsApi.addParam({component:'lmp_ratings',param:{name:'ratings_omdb_key',type:'input',values:'',default:D.ratings_omdb_key},field:{name:'API ключ (OMDb)',description:'Введи свій ключ OMDb. Можна отримати на omdbapi.com'}});Lampa.SettingsApi.addParam({component:'lmp_ratings',param:{name:'ratings_mdblist_key',type:'input',values:'',default:D.ratings_mdblist_key},field:{name:'API ключ (MDBList)',description:'Введи свій ключ MDBList. Можна отримати на mdblist.com'}});Lampa.SettingsApi.addParam({component:'lmp_ratings',param:{name:'ratings_bw_logos',type:'trigger',values:'',default:D.ratings_bw_logos},field:{name:'Монохромний режим (Ч/Б логотипи)',description:'Чорно-білі логотипи рейтингів'}});Lampa.SettingsApi.addParam({component:'lmp_ratings',param:{name:'ratings_rate_border',type:'trigger',default:D.ratings_rate_border},field:{name:'Рамка плиток рейтингів',description:'Додає рамку навколо кожної плитки.'}});Lampa.SettingsApi.addParam({component:'lmp_ratings',param:{name:'ratings_show_awards',type:'trigger',values:'',default:D.ratings_show_awards},field:{name:'Нагороди',description:'Показувати Оскари, Еммі та інші нагороди.'}});Lampa.SettingsApi.addParam({component:'lmp_ratings',param:{name:'ratings_show_average',type:'trigger',values:'',default:D.ratings_show_average},field:{name:'Середній рейтинг',description:'Показувати середній рейтинг'}});Lampa.SettingsApi.addParam({component:'lmp_ratings',param:{name:'ratings_logo_offset',type:'input',values:'',default:D.ratings_logo_offset},field:{name:'Розмір логотипів рейтингів',description:'Зміна висоти логотипів. \n"0" – стандарт, вводимо від "1" чи від "-1".'}});Lampa.SettingsApi.addParam({component:'lmp_ratings',param:{name:'ratings_font_offset',type:'input',values:'',default:D.ratings_font_offset},field:{name:'Розмір числа рейтингу',description:'Зміна розміру числа рейтингу та розміру фону. \n"0" – стандарт, вводимо від "1" чи від "-1".'}});Lampa.SettingsApi.addParam({component:'lmp_ratings',param:{name:'ratings_badge_alpha',type:'input',values:'',default:D.ratings_badge_alpha},field:{name:'Прозорість фону під рейтингом',description:'Прозорість фону. Стандартне значення: "0.15". \n"0" – прозорий, "1" – чорний.'}});Lampa.SettingsApi.addParam({component:'lmp_ratings',param:{name:'ratings_badge_tone',type:'input',values:'',default:D.ratings_badge_tone},field:{name:'Яскравість плиток',description:'Яскравість плиток. \n"0" – чорний. Від 0 до 255 (напр. "50" - темно-сірий).'}});Lampa.SettingsApi.addParam({component:'lmp_ratings',param:{name:'ratings_gap_step',type:'input',values:'',default:D.ratings_gap_step},field:{name:'Відступи між блоками (крок)',description:'Додатковий відступ. "0" – стандарт (0.3em). \nЩоб збільшити - вводимо від "1"'}});Lampa.SettingsApi.addParam({component:'lmp_ratings',param:{name:'ratings_colorize_all',type:'trigger',default:D.ratings_colorize_all},field:{name:'Кольорові оцінки рейтингів',description:'Кольорове виділення оцінок рейтингів'}});Lampa.SettingsApi.addParam({component:'lmp_ratings',param:{name:'ratings_enable_imdb',type:'trigger',default:D.ratings_enable_imdb},field:{name:'IMDb',description:'Показувати/ховати джерело'}});Lampa.SettingsApi.addParam({component:'lmp_ratings',param:{name:'ratings_enable_tmdb',type:'trigger',default:D.ratings_enable_tmdb},field:{name:'TMDB',description:'Показувати/ховати джерело'}});Lampa.SettingsApi.addParam({component:'lmp_ratings',param:{name:'ratings_enable_mc',type:'trigger',default:D.ratings_enable_mc},field:{name:'Metacritic',description:'Показувати/ховати джерело'}});Lampa.SettingsApi.addParam({component:'lmp_ratings',param:{name:'ratings_enable_rt',type:'trigger',default:D.ratings_enable_rt},field:{name:'RottenTomatoes',description:'Показувати/ховати джерело'}});Lampa.SettingsApi.addParam({component:'lmp_ratings',param:{name:'ratings_enable_popcorn',type:'trigger',default:D.ratings_enable_popcorn},field:{name:'Popcornmeter',description:'Показувати/ховати джерело'}});Lampa.SettingsApi.addParam({component:'lmp_ratings',param:{name:'ratings_enable_cub',type:'trigger',default:D.ratings_enable_cub},field:{name:'Cub rating',description:'Показувати/ховати рейтинг Cub (на основі реакцій)'}});Lampa.SettingsApi.addParam({component:'lmp_ratings',param:{name:'ratings_poster_badges',type:'trigger',default:D.ratings_poster_badges},field:{name:'Додаткові рейтинги на постері',description:'Показувати наявні та додаткові рейтинги на постері'}});Lampa.SettingsApi.addParam({component:'lmp_ratings',param:{type:'button',component:'lmp_clear_cache'},field:{name:'Очистити кеш рейтингів'},onChange:function(){try{Lampa.Storage.set(RCK,{});Lampa.Storage.set(IMC,{});!function(e){try{Lampa&&typeof Lampa.Noty=='function'?Lampa.Noty(e):Lampa&&Lampa.Noty&&Lampa.Noty.show?Lampa.Noty.show(e):function(e){var t='lmp_toast',n=document.getElementById(t);n||(n=document.createElement('div'),n.id=t,n.style.cssText='position:fixed;left:50%;transform:translateX(-50%);bottom:2rem;padding:.6rem 1rem;background:rgba(0,0,0,.85);color:#fff;border-radius:.5rem;z-index:9999;font-size:14px;transition:opacity .2s;opacity:0',document.body.appendChild(n));n.textContent=e;n.style.opacity='1';setTimeout(function(){n.style.opacity='0'},1300)}('Кеш рейтингів очищено')}catch(r){}}('Кеш рейтингів очищено')}catch(e){console.error('LMP Ratings: clear cache error',e);!function(e){try{Lampa&&typeof Lampa.Noty=='function'?Lampa.Noty(e):Lampa&&Lampa.Noty&&Lampa.Noty.show?Lampa.Noty.show(e):function(e){var t='lmp_toast',n=document.getElementById(t);n||(n=document.createElement('div'),n.id=t,n.style.cssText='position:fixed;left:50%;transform:translateX(-50%);bottom:2rem;padding:.6rem 1rem;background:rgba(0,0,0,.85);color:#fff;border-radius:.5rem;z-index:9999;font-size:14px;transition:opacity .2s;opacity:0',document.body.appendChild(n));n.textContent=e;n.style.opacity='1';setTimeout(function(){n.style.opacity='0'},1300)}('Помилка очищення кешу')}catch(r){}}('Помилка очищення кешу')}})}!function(){var e=Lampa.Storage.get('omdb_api_key');e&&!Lampa.Storage.get('ratings_omdb_key')&&Lampa.Storage.set('ratings_omdb_key',e)}();typeof Lampa.Storage.get('ratings_show_awards')=='undefined'&&Lampa.Storage.set('ratings_show_awards',!0);typeof Lampa.Storage.get('ratings_show_average')=='undefined'&&Lampa.Storage.set('ratings_show_average',!0);typeof Lampa.Storage.get('ratings_enable_cub')=='undefined'&&Lampa.Storage.set('ratings_enable_cub',!0);n();e();!function(){var e;function t(){clearTimeout(e);e=setTimeout(function(){try{typeof currentRatingsData=='object'&&currentRatingsData&&(function(e){var t=Lampa.Activity.active().activity.render();if(!t||!t[0])return;var n=gc(),r=$('.full-start__pg.hide',t);r.length&&e.ageRating&&(function(e){return['N/A','Not Rated','Unrated'].indexOf(e)===-1}(e.ageRating)&&r.removeClass('hide').text(AR[e.ageRating]||e.ageRating));var i=$('.rate--imdb',t);i.length&&(n.enableImdb&&e.imdb_display?(i.removeClass('hide'),i.find('> div').eq(0).text(parseFloat(e.imdb_display).toFixed(1)),i.find('.source--name').html('<img style="width:auto; display:inline-block; vertical-align:middle; object-fit:contain;" src="'+I.imdb+'" alt="IMDb">'),i.removeClass('rating--green rating--blue rating--orange rating--red'),n.colorizeAll&&e.imdb_for_avg&&!isNaN(e.imdb_for_avg)&&i.addClass(gR(parseFloat(e.imdb_for_avg)))):i.addClass('hide').removeClass('rating--green rating--blue rating--orange rating--red'));var o=$('.rate--tmdb',t);o.length&&(n.enableTmdb&&e.tmdb_display?(o.removeClass('hide'),o.find('> div').eq(0).text(parseFloat(e.tmdb_display).toFixed(1)),o.find('.source--name').html('<img style="width:auto; display:inline-block; vertical-align:middle; object-fit:contain;" src="'+I.tmdb+'" alt="TMDB">'),o.removeClass('hide rating--green rating--blue rating--orange rating--red'),n.colorizeAll&&e.tmdb_for_avg&&!isNaN(e.tmdb_for_avg)&&o.addClass(gR(parseFloat(e.tmdb_for_avg)))):o.addClass('hide').removeClass('rating--green rating--blue rating--orange rating--red'))}(currentRatingsData),function(e){var t=Lampa.Activity.active().activity.render();if(!t)return;var n=gPL(t);if(!n.length)return;var r=gc();!function(){var t=n.find('.rate--mc');if(!r.enableMc){t.remove();return}var i=null;e.mc_user_for_avg&&!isNaN(e.mc_user_for_avg)?i=parseFloat(e.mc_user_for_avg):e.mc_critic_for_avg&&!isNaN(e.mc_critic_for_avg)?i=parseFloat(e.mc_critic_for_avg):e.mc_for_avg&&!isNaN(e.mc_for_avg)?i=parseFloat(e.mc_for_avg):e.mc_display&&!isNaN(parseFloat(e.mc_display))&&(i=parseFloat(e.mc_display)>10?parseFloat(e.mc_display)/10:parseFloat(e.mc_display));if(i==null||isNaN(i)){t.remove();return}var o=i.toFixed(1),a=(e.mc_user_for_avg&&!isNaN(e.mc_user_for_avg)&&Math.abs(i-parseFloat(e.mc_user_for_avg))<.051)?I.metacritic:I.metascore;if(!t.length){t=$('<div class="full-start__rate rate--mc"><div>'+o+'</div><div class="source--name"></div></div>');t.find('.source--name').html('<img style="width:auto; display:inline-block; vertical-align:middle; object-fit:contain;" src="'+a+'" alt="Metacritic">');var c=n.find('.rate--imdb');c.length?t.insertAfter(c):n.append(t)}else{t.find('> div').eq(0).text(o);t.find('.source--name').html('<img style="width:auto; display:inline-block; vertical-align:middle; object-fit:contain;" src="'+a+'" alt="Metacritic">')}t.removeClass('rating--green rating--blue rating--orange rating--red');r.colorizeAll&&t.addClass(gR(i))}();!function(){var t=n.find('.rate--rt');if(!r.enableRt){t.remove();return}var i=null;e.rt_for_avg&&!isNaN(e.rt_for_avg)?i=parseFloat(e.rt_for_avg):e.rt_display&&!isNaN(parseFloat(e.rt_display))&&(i=parseFloat(e.rt_display)>10?parseFloat(e.rt_display)/10:parseFloat(e.rt_display));if(i==null||isNaN(i)){t.remove();return}var o=i.toFixed(1),a=e.rt_fresh?I.rotten_good:I.rotten_bad,c=e.rt_fresh?'border-radius:4px;':'';if(!t.length){t=$('<div class="full-start__rate rate--rt"><div>'+o+'</div><div class="source--name"></div></div>');t.find('.source--name').html('<img style="width:auto; display:inline-block; vertical-align:middle; object-fit:contain;'+c+'" src="'+a+'" alt="Rotten Tomatoes">');var u=n.find('.rate--mc');u.length?t.insertAfter(u):(u=n.find('.rate--imdb')).length?t.insertAfter(u):n.prepend(t)}else{t.find('> div').eq(0).text(o);t.find('.source--name').html('<img style="width:auto; display:inline-block; vertical-align:middle; object-fit:contain;'+c+'" src="'+a+'" alt="Rotten Tomatoes">')}t.removeClass('rating--green rating--blue rating--orange rating--red');r.colorizeAll&&t.addClass(gR(i))}();!function(){var t=n.find('.rate--popcorn');if(!r.enablePop){t.remove();return}var i=null;e.popcorn_for_avg&&!isNaN(e.popcorn_for_avg)?i=parseFloat(e.popcorn_for_avg):e.popcorn_display&&!isNaN(parseFloat(e.popcorn_display))&&(i=parseFloat(e.popcorn_display)>10?parseFloat(e.popcorn_display)/10:parseFloat(e.popcorn_display));if(i==null||isNaN(i)){t.remove();return}var o=i.toFixed(1);if(!t.length){t=$('<div class="full-start__rate rate--popcorn"><div>'+o+'</div><div class="source--name"></div></div>');t.find('.source--name').html('<img style="width:auto; display:inline-block; vertical-align:middle; object-fit:contain;" src="'+I.popcorn+'" alt="Audience">');var a=n.find('.rate--rt, .rate--mc, .rate--tmdb, .rate--imdb');a.length?t.insertAfter(a.last()):n.prepend(t)}else{t.find('> div').eq(0).text(o);t.find('.source--name').html('<img style="width:auto; display:inline-block; vertical-align:middle; object-fit:contain;" src="'+I.popcorn+'" alt="Audience">')}t.removeClass('rating--green rating--blue rating--orange rating--red');r.colorizeAll&&t.addClass(gR(i))}();!function(){var t=n.find('.rate--cub');if(!r.enableCub){t.remove();return}var i=null;e.cub_for_avg&&!isNaN(e.cub_for_avg)&&(i=parseFloat(e.cub_for_avg));if(i==null||isNaN(i)){t.remove();return}var o=i.toFixed(1);if(!t.length){t=$('<div class="full-start__rate rate--cub"><div>'+o+'</div><div class="source--name"></div></div>');t.find('.source--name').html('<span class="lmp-award-icon lmp-award-icon--cub"><img src="'+I.cub+'" alt="Cub" style="height:var(--lmp-h-cub);"></span>');var a=n.find('.rate--popcorn');a.length?t.insertAfter(a):(a=n.find('.full-start__rate').last()).length?t.insertAfter(a):n.prepend(t)}else{t.find('> div').eq(0).text(o);t.find('.source--name').html('<span class="lmp-award-icon lmp-award-icon--cub"><img src="'+I.cub+'" alt="Cub" style="height:var(--lmp-h-cub);"></span>')}t.removeClass('rating--green rating--blue rating--orange rating--red');r.colorizeAll&&t.addClass(gR(i))}();e.awards&&e.awards>0&&!n.find('.rate--awards').length&&$('<div class="full-start__rate rate--awards rate--gold"><div>'+e.awards+'</div><div class="source--name"></div></div>').find('.source--name').html('<img style="width:auto; display:inline-block; vertical-align:middle; object-fit:contain;" src="'+I.awards+'" alt="Awards">').attr('title',Lampa.Lang.translate('awards_other_label')).end().prependTo(n);e.emmy&&e.emmy>0&&!n.find('.rate--emmy').length&&$('<div class="full-start__rate rate--emmy rate--gold"><div>'+e.emmy+'</div><div class="source--name"></div></div>').find('.source--name').html('<span class="lmp-award-icon lmp-award-icon--emmy"><img src="'+I.emmy+'" alt="Emmy"></span>').attr('title',Lampa.Lang.translate('emmy_label')).end().prependTo(n);e.oscars&&e.oscars>0&&!n.find('.rate--oscars').length&&$('<div class="full-start__rate rate--oscars rate--gold"><div>'+e.oscars+'</div><div class="source--name"></div></div>').find('.source--name').html('<span class="lmp-award-icon lmp-award-icon--oscar"><img src="'+I.oscar+'" alt="Oscar"></span>').attr('title',Lampa.Lang.translate('oscars_label')).end().prependTo(n);try{!function(e,t){var r=e.find('.rate--awards, .rate--oscars, .rate--emmy');r.removeClass('rating--green rating--blue rating--orange rating--red');t&&t.colorizeAll?r.addClass('rate--gold'):r.removeClass('rate--gold')}(n,r)}catch(i){}}(currentRatingsData),function(e){var t=Lampa.Activity.active().activity.render();if(!t)return;var n=gPL(t);if(!n.length)return;var r=gc();n.find('.rate--avg').remove();if(!r.showAverage){try{!function(e,t){var r=e.find('.rate--awards, .rate--oscars, .rate--emmy');r.removeClass('rating--green rating--blue rating--orange rating--red');t&&t.colorizeAll?r.addClass('rate--gold'):r.removeClass('rate--gold')}(n,r)}catch(i){}rLA();uP(n);return}var o=[];r.enableTmdb&&e.tmdb_for_avg&&!isNaN(e.tmdb_for_avg)&&o.push(parseFloat(e.tmdb_for_avg));r.enableImdb&&e.imdb_for_avg&&!isNaN(e.imdb_for_avg)&&o.push(parseFloat(e.imdb_for_avg));if(r.enableMc){e.mc_user_for_avg&&!isNaN(e.mc_user_for_avg)?o.push(parseFloat(e.mc_user_for_avg)):e.mc_critic_for_avg&&!isNaN(e.mc_critic_for_avg)?o.push(parseFloat(e.mc_critic_for_avg)):e.mc_for_avg&&!isNaN(e.mc_for_avg)&&o.push(parseFloat(e.mc_for_avg))}r.enableRt&&e.rt_for_avg&&!isNaN(e.rt_for_avg)&&o.push(parseFloat(e.rt_for_avg));r.enablePop&&e.popcorn_for_avg&&!isNaN(e.popcorn_for_avg)&&o.push(parseFloat(e.popcorn_for_avg));r.enableCub&&e.cub_for_avg&&!isNaN(e.cub_for_avg)&&o.push(parseFloat(e.cub_for_avg));if(!o.length){rLA();uP(n);return}var a=0;for(var c=0;c<o.length;c++)a+=o[c];var u=a/o.length,s=r.colorizeAll?gR(u):'';$('<div class="full-start__rate rate--avg '+s+'"><div>'+u.toFixed(1)+'</div><div class="source--name"></div></div>').find('.source--name').html('<img style="width:auto; display:inline-block; vertical-align:middle; object-fit:contain;" src="'+I.total_star+'" alt="AVG">').end().insertBefore(n.find('.full-start__rate:first'));try{!function(e,t){var r=e.find('.rate--awards, .rate--oscars, .rate--emmy');r.removeClass('rating--green rating--blue rating--orange rating--red');t&&t.colorizeAll?r.addClass('rate--gold'):r.removeClass('rate--gold')}(n,r)}catch(l){}rLA();uP(n)}(currentRatingsData),l())}catch(i){}l()},150)}document.addEventListener('input',t,!0);document.addEventListener('change',t,!0);document.addEventListener('click',function(e){e.target.closest('[data-name^="ratings_"],[name^="ratings_"]')&&t()},!0);document.addEventListener('keyup',t,!0);try{Lampa.SettingsApi&&Lampa.SettingsApi.listener&&Lampa.SettingsApi.listener.follow&&Lampa.SettingsApi.listener.follow('change',function(e){e&&e.name&&e.name.indexOf('ratings_')===0&&t()})}catch(n){}}();Lampa.Listener.follow('line',function(e){if(e.type!=='append')return;var t=gc();if(!t.enablePosterBadges){e.items.forEach(function(e){try{removeRating(e.card)}catch(n){}});return}e.items.forEach(function(e){var n=e&&e.data,r=e&&e.card&&e.card.find('.card__view');if(!n||!r||!r.length)return;var i=n.number_of_seasons?'tv':'movie',o='poster_'+(n.type||i)+'_'+(n.imdb_id||n.id),a=gCK(o);if(a&&a._mdblist_ratings){!function(e,t){if(!t||!t.length)return;t.find('.card__lmerating').remove();var n=function(e){if(!Array.isArray(e))return[];var t=(Lampa.Storage.get('source')||'').toLowerCase()==='cub';return e.filter(function(e){if(!e)return!1;var n=function(e){if(!e||typeof e!='object')return null;var t=e.value;t==null&&(t=e.score);t==null&&(t=e.rating);t==null&&(t=e.percent);t==null&&typeof e.display=='string'&&(t=e.display);return t==null?null:t}(e);if(n==null)return!1;var r=String(e.source||'').toLowerCase();return!(r==='tmdb'||t&&r==='imdb')})}(e);if(!n.length)return;!function(){if(document.getElementById('lmp-poster-badges-css'))return;var e='.card__lmerating{position:absolute;right:-0.8em;padding:0.40em 0.60em;background:linear-gradient(90deg,#2c2c2c,#1a1a1a);color:#fff;border-radius:0.35em;text-transform:uppercase;font-size:0.80em;line-height:1;box-shadow:0 2px 6px rgba(0,0,0,.35);z-index:5;pointer-events:none}@media (max-width:768px){.card__lmerating{right:.2em;font-size:.74em}}@media (max-width:480px){.card__lmerating{right:.2em;font-size:.66em}}',t=document.createElement('style');t.id='lmp-poster-badges-css';t.textContent=e;document.head.appendChild(t)}();var i=.6;n.forEach(function(e,n){var o=function(e){if(!e||typeof e!='object')return null;var t=e.value;t==null&&(t=e.score);t==null&&(t=e.rating);t==null&&(t=e.percent);t==null&&typeof e.display=='string'&&(t=e.display);return t==null?null:t}(e);if(o==null)return;var a=String((e.source||'').toUpperCase())+': '+String(o);e.votes!=null&&(a+=' /'+String(e.votes));var c=$('<div class="card__lmerating"></div>');c.css('top','calc('+i+'em + '+n*2+'em)').text(a);t.append(c)})}(a._mdblist_ratings,r);else fM({id:n.id,type:i},function(e){e&&e._mdblist_ratings&&(sCK(o,{_mdblist_ratings:e._mdblist_ratings}),function(e,t){if(!t||!t.length)return;t.find('.card__lmerating').remove();var n=function(e){if(!Array.isArray(e))return[];var t=(Lampa.Storage.get('source')||'').toLowerCase()==='cub';return e.filter(function(e){if(!e)return!1;var n=function(e){if(!e||typeof e!='object')return null;var t=e.value;t==null&&(t=e.score);t==null&&(t=e.rating);t==null&&(t=e.percent);t==null&&typeof e.display=='string'&&(t=e.display);return t==null?null:t}(e);if(n==null)return!1;var r=String(e.source||'').toLowerCase();return!(r==='tmdb'||t&&r==='imdb')})}(e);if(!n.length)return;!function(){if(document.getElementById('lmp-poster-badges-css'))return;var e='.card__lmerating{position:absolute;right:-0.8em;padding:0.40em 0.60em;background:linear-gradient(90deg,#2c2c2c,#1a1a1a);color:#fff;border-radius:0.35em;text-transform:uppercase;font-size:0.80em;line-height:1;box-shadow:0 2px 6px rgba(0,0,0,.35);z-index:5;pointer-events:none}@media (max-width:768px){.card__lmerating{right:.2em;font-size:.74em}}@media (max-width:480px){.card__lmerating{right:.2em;font-size:.66em}}',t=document.createElement('style');t.id='lmp-poster-badges-css';t.textContent=e;document.head.appendChild(t)}();var i=.6;n.forEach(function(e,n){var o=function(e){if(!e||typeof e!='object')return null;var t=e.value;t==null&&(t=e.score);t==null&&(t=e.rating);t==null&&(t=e.percent);t==null&&typeof e.display=='string'&&(t=e.display);return t==null?null:t}(e);if(o==null)return;var a=String((e.source||'').toUpperCase())+': '+String(o);e.votes!=null&&(a+=' /'+String(e.votes));var c=$('<div class="card__lmerating"></div>');c.css('top','calc('+i+'em + '+n*2+'em)').text(a);t.append(c)})}(e._mdblist_ratings,r)})})})});window.LampaRatings=window.LampaRatings||{};window.LampaRatings.applyStyles=l;window.LampaRatings.getConfig=gc;l();window.combined_ratings_plugin||(window.combined_ratings_plugin=!0,Lampa.Listener.follow('full',function(e){if(e.type==='complite'){setTimeout(function(){fAR(e.data.movie||e.object||{},e);try{var t=Lampa.Activity.active().activity.render();if(t&&t[0]){var n=t[0].querySelectorAll('.full-start__rate > div:first-child');n.forEach(function(e){var t=(e.textContent||'').replace(/\u00A0/g,' ').trim();/^10(?:[.,]0+)?$/.test(t)&&(e.textContent='10')})}}catch(r){}},500)}}))}();window.addEventListener('resize',t);window.addEventListener('orientationchange',t)})();```